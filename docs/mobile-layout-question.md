# モバイルレイアウト方針（決定）

更新日: 2026-02-07

## 現状

PC版は横並び（動画 | コメントサイドバー）で問題なく動いています。

モバイル版が課題です。

### 試したアプローチ

1. **サイドバーオーバーレイ (fixed inset-0)** — 動画の上にコメントが全画面で覆う。動画が見えなくなる。
2. **縦スタック (flex-col, 動画40% / コメント60%)** — 動画が小さすぎる。コメント入力時にキーボードでさらに圧迫される。

どちらも使い勝手が悪いです。

### スクリーンショット

（添付: 現状のモバイル画面キャプチャ）

## 結論

**案B: ボトムシート（ハーフモーダル）を採用する。**

理由:

- 本要件は「動画を見ながらコメントを書く」ことが最優先。
- 案A（タブ切り替え）は動画とコメントが同時に見えず、要件を満たしにくい。
- 縦スタックは小画面で動画領域が不足し、キーボード表示時に破綻しやすい。
- ボトムシートなら動画を維持しつつ、必要時のみコメント領域を拡張できる。

## 比較メモ（残し）

検討時に比較したレイアウト案を残しておく。

### 案A: タブ切り替え

- 動画タブ（全画面） / コメントタブ を下タブで切り替え
- 動画を見ながらコメントは書けない
- 実装シンプル

### 案B: ボトムシート (ハーフモーダル)

- 動画は常時表示（上部）
- コメントはボトムシートで下からスワイプで出す（Google Maps風）
- 半分 / 全画面 の2段階
- 動画を見ながらコメントも見える
- 実装やや複雑（ドラッグ制御）

### 案C: 縦スタック（比率調整）

- 現在の方式を改善
- 動画を 50-60% に拡大、コメントは最小限の入力欄 + 直近コメント数件だけ表示
- コメント一覧は展開ボタンで全画面表示

### 案D: その他

- 別のアイデアがあれば教えてください

## 採用方針（案B詳細）

1. 動画領域は常時表示（最優先）
2. コメントはボトムシートで3状態
   - `closed`（最小バーのみ）
   - `half`（一覧と入力が使える）
   - `full`（コメント集中モード）
3. 初期状態は `closed` または `half`（ユーザーテストで決定）
4. 入力フォーカス時は自動で `half` 以上へ
5. キーボード表示時はシート高さを再計算して入力欄を必ず可視にする

## 実装メモ（React + Tailwind）

- `src/App.jsx`
  - モバイル時レイアウトを「動画 + ボトムシート」に分岐
  - `sheetState` (`closed | half | full`) を管理
- `src/components/CommentSection.jsx`
  - シート内で使う前提で高さ制約を調整（`min-h-0`, `overflow-y-auto`）
  - 入力欄固定、一覧スクロールの分離
- 必要に応じて新規 `src/components/MobileCommentSheet.jsx` を作成
  - ドラッグハンドル
  - スナップポイント制御
  - iOS Safari の viewport 変化対応

## 受け入れ条件

- 再生中の動画を見ながらコメント投稿できる
- 入力中（キーボード表示）でも動画と入力欄の両方が破綻しない
- シート操作（開閉・半展開・全展開）が 60fps 近くで滑らか
- iOS Safari / Chrome で同等の操作感を維持

## 補足情報

- 主な利用シーン: 動画を見ながらタイムコード付きコメントを打つ
- ユーザーは動画の特定箇所を見ながらコメントを書きたい
- 現在の技術: React 19 + Tailwind CSS (SPA)
- 対象ブラウザ: iOS Safari / Chrome

## 現在のコード構成

- `src/App.jsx` — レイアウト制御（`isMobile` state で分岐）
- `src/components/CommentSection.jsx` — コメント一覧 + 入力フォーム
- `src/components/VideoPlayer.jsx` — 動画プレイヤー

モバイル判定: `window.innerWidth <= 768`
